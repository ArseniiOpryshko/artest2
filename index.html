<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR.js - QR AR с сохранением объекта</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/ar.js/1.7.2/aframe/build/aframe-ar.min.js"></script>
</head>

<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- QR-код как маркер -->
        <a-marker id="marker" type="pattern" url="pattern-qr.patt">
            <a-entity id="model" gltf-model="model.glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-marker>
        <a-camera position="0 0 0"></a-camera>
    </a-scene>

    <script>
        let model = document.getElementById("model");
        let marker = document.getElementById("marker");

        marker.addEventListener("markerFound", () => {
            console.log("Маркер найден! Позиция зафиксирована.");
            let pos = model.getAttribute("position");  // Запоминаем позицию
            model.setAttribute("visible", true);
            model.setAttribute("savedPosition", pos);
        });

        marker.addEventListener("markerLost", () => {
            console.log("Маркер потерян, но объект остается.");
            let savedPos = model.getAttribute("savedPosition");
            model.setAttribute("position", savedPos); // Оставляем объект в той же позиции
            model.setAttribute("visible", true); // Объект остается видимым
        });
    </script>
</body>

</html>